pv.Behavior.tipsy=function(opts){var tip;function trigger(){if(tip){$(tip).tipsy("hide");tip.parentNode.removeChild(tip);tip=null}}
return function(d){var t=pv.Transform.identity,p=this.parent;do{t=t.translate(p.left(),p.top()).times(p.transform())}while(p=p.parent);if(!tip){var c=this.root.canvas();c.style.position="relative";$(c).mouseleave(trigger);tip=c.appendChild(document.createElement("div"));tip.style.position="absolute";tip.style.pointerEvents="none";$(tip).tipsy(opts)}
tip.title=this.title()||this.text();if(tip.title.charAt(1)==":"){tip.title=tip.title.substr(2,tip.title.length)}else if(tip.title.charAt(2)==":"){tip.title=tip.title.substr(3,tip.title.length)}else if(tip.title.charAt(4)==":"){tip.title=tip.title.substr(4,tip.title.length)}
if(this.properties.width){tip.style.width=Math.ceil(this.width()*t.k)+100+"px";tip.style.height=Math.ceil(this.height()*t.k)+1+"px"}else if(this.properties.radius){var r=this.radius();t.x-=r;t.y-=r;tip.style.height=tip.style.width=Math.ceil(2*r*t.k)+"px"}
tip.style.left=Math.floor(this.left()*t.k+t.x)-80+"px";tip.style.top=Math.floor(this.top()*t.k+t.y)+"px";if(tip.style.height)$(pv.event.target).mouseleave(trigger);$(tip).tipsy("show")}}